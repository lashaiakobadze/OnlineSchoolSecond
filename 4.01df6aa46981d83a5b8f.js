(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{Yj9t:function(e,t,r){"use strict";r.r(t),r.d(t,"AuthModule",function(){return P});var i=r("tyNb"),n=r("3Pt+"),o=r("PCNd"),s=r("P+IX"),a=r("fXoL");let l=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Db({type:e,selectors:[["app-auth"]],decls:1,vars:0,template:function(e,t){1&e&&a.Kb(0,"router-outlet")},directives:[i.h],styles:[""]}),e})(),c=(()=>{class e{constructor(){this.closeAlert=new a.n}ngOnInit(){}onCloseAlert(){this.closeAlert.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Db({type:e,selectors:[["app-alert"]],inputs:{message:"message"},outputs:{closeAlert:"closeAlert"},decls:7,vars:1,consts:[[1,"backdrop",3,"click"],[1,"alert-box"],[1,"alert-box-actions"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(a.Ob(0,"div",0),a.Vb("click",function(){return t.onCloseAlert()}),a.Nb(),a.Ob(1,"div",1),a.Ob(2,"p"),a.mc(3),a.Nb(),a.Ob(4,"div",2),a.Ob(5,"button",3),a.Vb("click",function(){return t.onCloseAlert()}),a.mc(6,"close"),a.Nb(),a.Nb(),a.Nb()),2&e&&(a.zb(3),a.nc(t.message))},styles:[".backdrop[_ngcontent-%COMP%]{background:rgba(0,0,0,.75);height:100Vh;left:0;position:fixed;top:0;width:100vw;z-index:50}.alert-box[_ngcontent-%COMP%]{background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.26);left:20vw;padding:16px;position:fixed;top:30vh;width:60vw;z-index:100}.alert-box-actions[_ngcontent-%COMP%]{text-align:right}"]}),e})(),b=(()=>{class e{constructor(e){this.viewContainerRef=e}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(a.P))},e.\u0275dir=a.Eb({type:e,selectors:[["","appPlaceholder",""]]}),e})();var u=r("qXBG"),m=r("ofXK"),p=r("zy28");function d(e,t){1&e&&(a.Ob(0,"div",5),a.Kb(1,"app-loading-spinner"),a.Nb())}function h(e,t){if(1&e){const e=a.Pb();a.Ob(0,"form",6,7),a.Vb("ngSubmit",function(){a.gc(e);const t=a.ec(1);return a.Xb().onLogin(t)}),a.Ob(2,"div",8),a.Ob(3,"label",9),a.mc(4,"E-Mail"),a.Nb(),a.Kb(5,"input",10),a.Nb(),a.Ob(6,"div",8),a.Ob(7,"label",11),a.mc(8,"Password"),a.Nb(),a.Kb(9,"input",12),a.Nb(),a.Ob(10,"div",8),a.Ob(11,"button",13),a.mc(12,"LogIn"),a.Nb(),a.Nb(),a.Ob(13,"button",14),a.Ob(14,"a",15),a.mc(15,"Sign Up"),a.Nb(),a.Nb(),a.Nb()}if(2&e){const e=a.ec(1);a.zb(11),a.Yb("disabled",!e.valid)}}let g=(()=>{class e{constructor(e,t,r){this.authService=e,this.router=t,this.componentFactoryResolver=r}ngOnInit(){}onLogin(e){if(!e.valid)return;const t=e.value.email,r=e.value.password;this.authService.isLoading=!0,this.authService.authObs=this.authService.login(t,r),this.authService.authObs.subscribe(e=>{this.router.navigate(["/home"]),this.authService.isLoading=!1},e=>{this.authService.error=e,this.showErrorAlert(e),this.authService.isLoading=!1})}onHandleError(){this.authService.error=null}showErrorAlert(e){const t=this.componentFactoryResolver.resolveComponentFactory(c),r=this.alertHost.viewContainerRef;r.clear();const i=r.createComponent(t);i.instance.message=e,this.closeSub=i.instance.closeAlert.subscribe(()=>{this.closeSub.unsubscribe(),r.clear(),this.onHandleError()})}ngOnDestroy(){this.closeSub&&this.closeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(u.a),a.Jb(i.d),a.Jb(a.j))},e.\u0275cmp=a.Db({type:e,selectors:[["app-login"]],viewQuery:function(e,t){if(1&e&&a.qc(b,1),2&e){let e;a.dc(e=a.Wb())&&(t.alertHost=e.first)}},decls:5,vars:2,consts:[["appPlaceholder",""],[1,"row"],[1,"col-xs-12","col-md-6","col-md-offset-3"],["class","spinner",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],[1,"spinner"],[3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["for","email"],["type","email","id","email","ngModel","","name","email","required","","email","",1,"form-control"],["for","password"],["type","password","id","password","ngModel","","name","password","required","","minlength","6",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary"],["routerLink","../sign-up"]],template:function(e,t){1&e&&(a.Kb(0,"ng-component",0),a.Ob(1,"div",1),a.Ob(2,"div",2),a.lc(3,d,2,0,"div",3),a.lc(4,h,16,1,"form",4),a.Nb(),a.Nb()),2&e&&(a.zb(3),a.Yb("ngIf",t.authService.isLoading),a.zb(1),a.Yb("ngIf",!t.authService.isLoading))},directives:[i.i,b,m.j,p.a,n.s,n.j,n.k,n.a,n.i,n.l,n.p,n.b,n.h,i.f],styles:[".spinner[_ngcontent-%COMP%]{text-align:center}"]}),e})();function f(e,t){if(1&e&&(a.Ob(0,"div",5),a.Ob(1,"p"),a.mc(2),a.Nb(),a.Nb()),2&e){const e=a.Xb();a.zb(2),a.nc(e.authService.error)}}function v(e,t){1&e&&(a.Ob(0,"div",6),a.Kb(1,"app-loading-spinner"),a.Nb())}function N(e,t){if(1&e){const e=a.Pb();a.Ob(0,"form",7,8),a.Vb("ngSubmit",function(){a.gc(e);const t=a.ec(1);return a.Xb().onSignUp(t)}),a.Ob(2,"div",9),a.Ob(3,"label",10),a.mc(4,"E-Mail"),a.Nb(),a.Kb(5,"input",11),a.Nb(),a.Ob(6,"div",9),a.Ob(7,"label",12),a.mc(8,"Password"),a.Nb(),a.Kb(9,"input",13),a.Nb(),a.Ob(10,"div",9),a.Ob(11,"button",14),a.mc(12,"Sign up"),a.Nb(),a.Nb(),a.Nb()}if(2&e){const e=a.ec(1);a.zb(11),a.Yb("disabled",!e.valid)}}let O=(()=>{class e{constructor(e,t,r){this.authService=e,this.router=t,this.route=r}ngOnInit(){}onSignUp(e){if(!e.valid)return;const t=e.value.email,r=e.value.password;this.authService.isLoading=!0,this.authService.authObs=this.authService.signUp(t,r),this.authService.authObs.subscribe(e=>{this.router.navigate(["../registration"],{relativeTo:this.route}),this.authService.isLoading=!1},e=>{this.authService.error=e,this.authService.isLoading=!1})}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(u.a),a.Jb(i.d),a.Jb(i.a))},e.\u0275cmp=a.Db({type:e,selectors:[["app-sign-up"]],decls:5,vars:3,consts:[[1,"row"],[1,"col-xs-12","col-md-6","col-md-offset-3"],["class","alert alert-danger",4,"ngIf"],["class","spinner",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],[1,"alert","alert-danger"],[1,"spinner"],[3,"ngSubmit"],["signUpForm","ngForm"],[1,"form-group"],["for","email"],["type","email","name","email","ngModel","","email","","required","",1,"form-control"],["for","password"],["type","password","id","password","ngModel","","name","password","minlength","6","required","",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,t){1&e&&(a.Ob(0,"div",0),a.Ob(1,"div",1),a.lc(2,f,3,1,"div",2),a.lc(3,v,2,0,"div",3),a.lc(4,N,13,1,"form",4),a.Nb(),a.Nb()),2&e&&(a.zb(2),a.Yb("ngIf",t.authService.error),a.zb(1),a.Yb("ngIf",t.authService.isLoading),a.zb(1),a.Yb("ngIf",!t.authService.isLoading))},directives:[m.j,p.a,n.s,n.j,n.k,n.a,n.i,n.l,n.b,n.p,n.h],styles:[".spinner[_ngcontent-%COMP%]{text-align:center}"]}),e})();class w{constructor(e,t,r,i,n,o,s){this.firstName=e,this.lastName=t,this.personalNumber=r,this.phone=i,this.imgLink=n,this.group=o,this.email=s}}function S(e,t){1&e&&(a.Ob(0,"div",4),a.Kb(1,"app-loading-spinner"),a.Nb())}function y(e,t){1&e&&a.Kb(0,"input",23)}function I(e,t){1&e&&a.Kb(0,"input",23)}function L(e,t){if(1&e&&(a.Ob(0,"span",24),a.mc(1),a.Nb()),2&e){const e=a.Xb(2);a.zb(1),a.nc(e.errorMessage)}}function F(e,t){if(1&e){const e=a.Pb();a.Ob(0,"form",5),a.Vb("ngSubmit",function(){return a.gc(e),a.Xb().onRegister()}),a.Ob(1,"div",6),a.Ob(2,"label",7),a.mc(3,"First name"),a.Nb(),a.Kb(4,"input",8),a.Nb(),a.Ob(5,"div",6),a.Ob(6,"label",9),a.mc(7,"Last name"),a.Nb(),a.Kb(8,"input",10),a.Nb(),a.Ob(9,"div",6),a.Ob(10,"label",11),a.mc(11,"Personal number"),a.Nb(),a.Kb(12,"input",12),a.Nb(),a.Ob(13,"div",6),a.Ob(14,"label",13),a.mc(15,"Phone number"),a.Nb(),a.Kb(16,"input",14),a.Nb(),a.Ob(17,"div",6),a.Ob(18,"label",15),a.mc(19,"Image link"),a.Nb(),a.Kb(20,"input",16),a.Nb(),a.Ob(21,"div",6),a.Ob(22,"label",17),a.mc(23,"Group:"),a.Nb(),a.Ob(24,"select",18),a.Ob(25,"option"),a.mc(26,"A"),a.Nb(),a.Ob(27,"option"),a.mc(28,"B"),a.Nb(),a.Ob(29,"option"),a.mc(30,"C"),a.Nb(),a.Ob(31,"option"),a.mc(32,"D"),a.Nb(),a.Nb(),a.Nb(),a.Ob(33,"div",6),a.Ob(34,"label",19),a.mc(35,"Email"),a.Nb(),a.lc(36,y,1,0,"input",20),a.lc(37,I,1,0,"input",20),a.lc(38,L,2,1,"span",21),a.Nb(),a.Ob(39,"div",6),a.Ob(40,"button",22),a.mc(41,"Register"),a.Nb(),a.Nb(),a.Nb()}if(2&e){const e=a.Xb();a.Yb("formGroup",e.registerForm),a.zb(36),a.Yb("ngIf",e.registerForm.valid),a.zb(1),a.Yb("ngIf",!e.registerForm.valid),a.zb(1),a.Yb("ngIf",!e.correctEmail),a.zb(2),a.Yb("disabled",!e.registerForm.valid)}}const C=[{path:"",component:l,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:g},{path:"sign-up",component:O},{path:"registration",component:(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.correctEmail=!0,this.errorMessage=null}ngOnInit(){this.registerForm=new n.e({firstName:new n.c(null,[n.r.required]),lastName:new n.c(null,[n.r.required]),personalNumber:new n.c(null,[n.r.required,n.r.minLength(11),n.r.maxLength(11)]),phone:new n.c(null,[n.r.required]),imgLink:new n.c(null,[n.r.required]),group:new n.c(null,[n.r.required]),email:new n.c(null,[n.r.required,n.r.email])}),this.authService.user.subscribe(e=>{if(!e)return"user is null";this.profilesEmail=e.email}),this.authService.fetchProfiles().subscribe(),this.profiles=this.authService.getProfiles()}onRegister(){this.newRegistration=new w(this.registerForm.value.firstName,this.registerForm.value.lastName,this.registerForm.value.personalNumber,this.registerForm.value.phone,this.registerForm.value.imgLink,this.registerForm.value.group,this.registerForm.value.email),this.profilesEmail==this.registerForm.value.email?this.profiles.find(e=>e.email==this.registerForm.value.email)?(this.correctEmail=!1,this.errorMessage="Registration with this email has already been done!"):(this.profiles.push(this.newRegistration),this.authService.addProfile(this.profiles),this.registerForm.reset(),this.errorMessage=null,this.router.navigate(["./home"])):(this.correctEmail=!1,this.errorMessage="You are not signed up with this email!")}}return e.\u0275fac=function(t){return new(t||e)(a.Jb(u.a),a.Jb(i.d))},e.\u0275cmp=a.Db({type:e,selectors:[["app-registration"]],decls:4,vars:2,consts:[[1,"row"],[1,"col-xs-12","col-md-6","col-md-offset-3"],["class","spinner",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"spinner"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","firstName"],["type","text","formControlName","firstName",1,"form-control"],["for","lastName"],["type","text","formControlName","lastName",1,"form-control"],["for","personalNumber"],["type","text","formControlName","personalNumber",1,"form-control"],["for","phone"],["type","tel","formControlName","phone",1,"form-control"],["for","imgLink"],["type","url","formControlName","imgLink",1,"form-control"],["for","sel1"],["formControlName","group","id","sel1",1,"form-control"],["for","email"],["type","email","class","form-control","formControlName","email",4,"ngIf"],["style","color: red;",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled"],["type","email","formControlName","email",1,"form-control"],[2,"color","red"]],template:function(e,t){1&e&&(a.Ob(0,"div",0),a.Ob(1,"div",1),a.lc(2,S,2,0,"div",2),a.lc(3,F,42,5,"form",3),a.Nb(),a.Nb()),2&e&&(a.zb(2),a.Yb("ngIf",t.authService.isLoading),a.zb(1),a.Yb("ngIf",!t.authService.isLoading))},directives:[m.j,p.a,n.s,n.j,n.f,n.a,n.i,n.d,n.q,n.m,n.t],styles:[""]}),e})(),resolve:[r("FW2d").a],canActivate:[s.a]}]}];let x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({imports:[[i.g.forChild(C)],i.g]}),e})(),P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Hb({type:e}),e.\u0275inj=a.Gb({imports:[[n.g,n.o,i.g,x,o.a]]}),e})()}}]);